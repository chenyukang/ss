在一个有向无环图中，图上有多条边，每个边有两个属性: min_amount 表示如果这条边的最小流通量(如果是 0 则表示不限制最小流通量)，max_amount 表示最大流通量。

现在给定一个 amount 和 M, 分别表示需要通过的流量和最大允许分割的数量，我现在要找到最多 M 条路径，传递 amount。我们来个例子，假设图：

```
(1 -> 2 min:0 max:100)
(1 -> 2 min:0 max:100)
(2 -> 3 min:0 max:320)

给定的：
amount = 150, N = 1

结果：
无法找到路径，因为 1 -> 2 之间最多能通过 100，而我们只能找一条路径，因为 N = 1

如果给定输入：
amount = 150, N = 3
结果可以找到两条路径 :
第一条路径：(1 -> 2 -> 3 100).
第二条路径：(1 -> 2 -> 3 50)

-------

另一个例子：
(1 -> 2 min:0 max:100)
(1 -> 2 min:0, max:100)
(2 -> 3 min:0, max:80)

给定：
amount = 150, N = 3

结果：无法找到路径，因为 2 -> 3 最多只能传输 80

------

另一个例子：
(1 -> 2 min: max:150)
(2 -> 3 min:0 max:90)
(2 -> 3 min:20 max:30)
(3 -> 4 min:0, max:150)

给定：
amount = 100, N = 2

结果：可以找到两条路径 (1 -> 2 -> 3: 80) (1 -> 2 -> 3: 20)

```


 请给我理解分析这个问题，并给出一个合理的算法。

 -------
 实际 fiber 中这个问题存在更多其他限制，比如中间节点可能会按照一定的比率收费 fee_rate * amount，而支付者可能会设置一个最大的 max_fee，这样保证整个传递的 fee 不大于 max_fee.
 还有可能中间节点会设置 expiry，一条支付链路中的 expiry 会累积，总的 expiry 不能大于支付者设置的 expiry_limit。
 
